<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Play Framework · IxiaS</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='Documentation for IxiaS'/>
<link rel="canonical" href="https://nextbeat-dev.github.io/ixias/04-Play-Framework.html"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="js/page.js"></script>
<script type="text/javascript" src="js/warnOldVersion.js"></script>
<script type="text/javascript" src="js/groups.js"></script>
<script type="text/javascript" src="js/snippets.js"></script>
<link rel="stylesheet" type="text/css" href="lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="css/page.css"/>

<!--
<link rel="shortcut icon" href="images/favicon.ico" />
-->
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="index.html" >
<span class="home-icon">⌂</span>IxiaS
</a>
<div class="version-number">
2.3.0
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="01-Entity-Model.html" class="page">Entity Model</a></li>
  <li><a href="02-Enum.html" class="page">Enum</a></li>
  <li><a href="03-Slick.html" class="page">Slick</a></li>
  <li><a href="04-Play-Framework.html" class="active page">Play Framework</a></li>
  <li><a href="05-AWS.html" class="page">AWS</a></li>
  <li><a href="06-Image-Resource.html" class="page">Image Resource</a></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<header class="site-header expanded row">
<div class="small-12 column">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title"><a href="index.html">IxiaS</a></div>

<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column">
<nav class="site-nav">
<div class="nav-home">
<a href="index.html" >
<span class="home-icon">⌂</span>IxiaS
</a>
<div class="version-number">
2.3.0
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="01-Entity-Model.html" class="page">Entity Model</a></li>
  <li><a href="02-Enum.html" class="page">Enum</a></li>
  <li><a href="03-Slick.html" class="page">Slick</a></li>
  <li><a href="04-Play-Framework.html" class="active page">Play Framework</a></li>
  <li><a href="05-AWS.html" class="page">AWS</a></li>
  <li><a href="06-Image-Resource.html" class="page">Image Resource</a></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column">
<section class="site-content">

<span id="version-warning"></span>

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="index.html">IxiaS</a></li>
  <li>Play Framework</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#play-framework" name="play-framework" class="anchor"><span class="anchor-link"></span></a>Play Framework</h1>
<p>この章では、IxiaSがラップしているPlayFrameworkの使い方を説明します。</p>
<p>プロジェクトに以下の依存関係を設定する必要があります。</p>
<pre class="prettyprint"><code class="language-scala">libraryDependencies ++= Seq(
  &quot;net.ixias&quot; %% &quot;ixias-play-core&quot; % &quot;2.3.0&quot;
)
</code></pre>
<h2><a href="#jsonhelper" name="jsonhelper" class="anchor"><span class="anchor-link"></span></a>JsonHelper</h2>
<p><code>ixias-play-core</code> には、Jsonのシリアライズ/デシリアライズを行うためのヘルパークラスが含まれています。</p>
<p>JsonHelperは、Play FrameworkのリクエストデータをJSONとしてバインドするためのヘルパートレイトです。このトレイトは、リクエストデータを特定の型Tにバインドするための<code>bindFromRequest[T]</code>メソッドを提供します。また、JsonHelperトレイトはJsonHelperオブジェクトにミックスインされており、このオブジェクトを通じてメソッドを利用することができます。</p>
<pre class="prettyprint"><code class="language-scala">trait JsonHelper {

  /** To bind request data to a `T` component.
    */
  def bindFromRequest[T](implicit req: Request[AnyContent], reads: Reads[T]): Either[Result, T]
}
</code></pre>
<p>以下に、JsonHelperオブジェクトの使用方法を示します。</p>
<p>まず、bindFromRequest[T]メソッドを使用してリクエストデータをバインドします。このメソッドは、リクエストデータを指定した型Tにバインドしようと試み、成功した場合はRight[T]を、失敗した場合はLeft[Result]を返します。</p>
<p>このメソッドを使用する際には、T型のデータをJSONから変換するためのReads[T]インスタンスが必要です。このReadsは、Play FrameworkのJSONライブラリ、Play Jsonを使用して生成します。</p>
<pre class="prettyprint"><code class="language-scala">def myAction = Action { implicit request =&gt;
  JsonHelper.bindFromRequest[MyData] match {
    case Right(myData) =&gt;
      // バインドに成功した場合の処理
      Ok(&quot;Got data: &quot; + myData)
    case Left(badRequest) =&gt;
      // バインドに失敗した場合の処理
      badRequest
  }
}
</code></pre>
<p>ここで、MyDataはリクエストデータを表す任意の型で、この型に対するReadsインスタンスが必要です。Readsは、JSONデータをScalaのオブジェクトに変換するための型クラスです。このReadsインスタンスは通常、Json.reads[MyData]メソッドを使用して自動的に生成されます。</p>
<pre class="prettyprint"><code class="language-scala">case class MyData(name: String, age: Int)

object MyData {
  implicit val reads: Reads[MyData] = Json.reads[MyData]
}
</code></pre>
<p>以上がJsonHelperオブジェクトの基本的な使用方法です。このオブジェクトを使用することで、Play Frameworkのリクエストデータを簡単にJSONとしてバインドすることができます。</p>
<h2><a href="#formhelper" name="formhelper" class="anchor"><span class="anchor-link"></span></a>FormHelper</h2>
<p>FormHelperは、Play Frameworkのリクエストデータを特定の型Tにバインドするためのヘルパートレイトです。このトレイトは、リクエストデータを特定の型TにバインドするためのbindFromRequest[T]メソッドを提供します。また、FormHelperトレイトはFormHelperオブジェクトにミックスインされており、このオブジェクトを通じてメソッドを利用することができます。</p>
<pre class="prettyprint"><code class="language-scala">trait FormHelper {

  /** To bind request data to a `T` component.
    */
  def bindFromRequest[T](mapping: Mapping[T])(implicit
    req:      Request[_],
    provider: MessagesProvider
  ): Either[Result, T]
}
</code></pre>
<p>以下に、FormHelperオブジェクトの使用方法を示します。</p>
<p>まず、bindFromRequest[T]メソッドを使用してリクエストデータをバインドします。このメソッドは、リクエストデータを指定した型Tにバインドしようと試み、成功した場合はRight[T]を、失敗した場合はLeft[Result]を返します。</p>
<p>このメソッドを使用する際には、T型のデータをフォームから変換するためのMapping[T]インスタンスが必要です。このMappingは、Play Frameworkのフォームライブラリを使用して生成します。</p>
<pre class="prettyprint"><code class="language-scala">import play.api.data._
import play.api.data.Forms._

case class MyData(name: String, age: Int)

val myDataMapping: Mapping[MyData] = mapping(
  &quot;name&quot; -&gt; text,
  &quot;age&quot;  -&gt; number
)(MyData.apply)(MyData.unapply)

def myAction = Action { implicit request =&gt;
  FormHelper.bindFromRequest(myDataMapping) match {
    case Right(myData) =&gt;
      // バインドに成功した場合の処理
      Ok(&quot;Got data: &quot; + myData)
    case Left(badRequest) =&gt;
      // バインドに失敗した場合の処理
      badRequest
  }
}
</code></pre>
<p>この例では、まずMyData型のMappingインスタンスをmappingメソッドで生成しています。このMappingインスタンスは、フォームデータをMyData型のオブジェクトに変換する方法を定義しています。そして、bindFromRequest[MyData]メソッドを使用して、リクエストデータをMyData型にバインドしています。</p>
<p>以上がFormHelperオブジェクトの基本的な使用方法です。このオブジェクトを使用することで、Play Frameworkのリクエストデータを簡単に特定の型にバインドすることができます。</p>
<h2><a href="#binder" name="binder" class="anchor"><span class="anchor-link"></span></a>Binder</h2>
<p>Bindersは、特定の型のデータをリクエストパラメータからバインドするためのヘルパートレイトです。このトレイトは、QueryStringBindableやPathBindableなどのインスタンスを提供します。これらのインスタンスは、リクエストパラメータを特定の型にバインドするためのメソッドを提供します。</p>
<p>以下に、Bindersの使用方法を示します。</p>
<p>まず、PathBindableとQueryStringBindableのインスタンスを定義します。これらのインスタンスは、リクエストパラメータを特定の型にバインドするためのメソッドを提供します。</p>
<pre class="prettyprint"><code class="language-scala">import ixias.play.api.mvc.Binders._

trait Binders extends ixias.play.api.mvc.Binders {

  val Hoge = pacage.hoge.Hoge

  implicit val pathBind: PathBindable[Box[Hoge.Id]] = pathBindableBoxId[Hoge.Id]
  implicit val queryBind: QueryStringBindable[Box[Hoge.Id]] = queryStringBindableBoxId[Hoge.Id]
}
</code></pre>
<p>※ Play Frameworkのroutesファイルはテキストファイルを処理してルーティングの構築を行なっています。そのためバインドを行う型情報は全てパッケージのフルパスを記載するか、変数として定義しておきルーティングの変換処理でも参照できるようにしておかなければいけません。</p>
<p>作成したBindersをPlay Frameworkのルーティングで使用できるようにbuild.sbtに設定します。</p>
<pre class="prettyprint"><code class="language-sbt">RoutesKeys.routesImport := Seq(
  &quot;Binders._&quot;
)
</code></pre>
<p>次に、routesファイルでこれらのバインダーを使用します。以下の例では、:idパスパラメータをBox[Location.Id]型にバインドしています。</p>
<pre class="prettyprint"><code class="language-scala">GET /hoge/:id controllers.HogeController.getById(id: Box[Hoge.Id])
</code></pre>
<p>最後に、コントローラーでバインドされたパラメータを使用します。以下の例では、getByIdメソッドのidパラメータがBox[Hoge.Id]型になっています。</p>
<pre class="prettyprint"><code class="language-scala">def getById(id: Hoge.Id) = Action async {
   // ...
}
</code></pre>
<p>パスパラメーターではなくクエリパラメーターとしてバインドする場合は<code>BoxCsv</code>を使用してroutesファイルを以下のように記載します。</p>
<pre class="prettyprint"><code class="language-scala">GET /hoge controllers.HogeController.getById(id: BoxCsv[Hoge.Id])
</code></pre>
<p>以上がBindersの基本的な使用方法です。このトレイトを使用することで、Play Frameworkのリクエストパラメータを簡単に特定の型にバインドすることができます。</p>
<h2><a href="#devicedetection" name="devicedetection" class="anchor"><span class="anchor-link"></span></a>DeviceDetection</h2>
<p>DeviceDetectionBuilderは、ユーザーエージェントに基づいてデバイス情報を検出するためのカスタムアクションを提供します。これにより、リクエストが行われたデバイスのOS、デバイスタイプ、ユーザーエージェント、モバイルデバイスかどうかといった情報を取得することができます</p>
<p>以下に、DeviceDetectionBuilderの使用方法を示します。</p>
<p>まず、DeviceDetectionアクションをコントローラーのアクションメソッドで使用します。このアクションは、リクエストのユーザーエージェントを解析し、デバイス情報をリクエスト属性として追加します。</p>
<pre class="prettyprint"><code class="language-scala">def myAction = DeviceDetectionBuilder(play.api.mvc.parse.default) { request =&gt;
  // デバイス情報を取得
  val os        = request.attrs(DeviceDetectionAttrKey.OS)
  val device    = request.attrs(DeviceDetectionAttrKey.Device)
  val userAgent = request.attrs(DeviceDetectionAttrKey.UserAgent)
  val isMobile  = request.attrs(DeviceDetectionAttrKey.IsMobile)

  // デバイス情報を使用した処理
  Ok(s&quot;OS: $os, Device: $device, UserAgent: $userAgent, IsMobile: $isMobile&quot;)
}
</code></pre>
<p>この例では、DeviceDetectionアクションを使用してリクエストを処理しています。このアクションは、リクエストのユーザーエージェントを解析し、デバイス情報をリクエスト属性として追加します。その後、これらの属性を取得して使用します。</p>
<p>以上がDeviceDetectionBuilderの基本的な使用方法です。このビルダーを使用することで、Play Frameworkのリクエストからデバイス情報を簡単に取得することができます。</p>
<h2><a href="#requestheaderattrhelper" name="requestheaderattrhelper" class="anchor"><span class="anchor-link"></span></a>RequestHeaderAttrHelper</h2>
<p>RequestHeaderAttrHelperは、Play Frameworkのリクエストヘッダーから特定の属性を取得するためのヘルパーオブジェクトです。このヘルパーは、リクエストヘッダーに格納された特定のキーに対応する値を取得するためのメソッドを提供します。 </p>
<p>以下に、RequestHeaderAttrHelperの使用方法を示します。</p>
<p>まず、RequestHeaderAttrHelperのgetメソッドを使用してリクエストヘッダーから特定の属性を取得します。このメソッドは、指定したキーに対応する値を取得しようと試み、成功した場合はRight[T]を、失敗した場合はLeft[Result]を返します。</p>
<pre class="prettyprint"><code class="language-scala">import ixias.play.api.mvc.RequestHeaderAttrHelper
import play.api.mvc.{ RequestHeader, Result }
import play.api.libs.typedmap.TypedKey

// TypedKeyの定義
val MyKey: TypedKey[String] = TypedKey[String](&quot;myKey&quot;)

def myAction() = Action { implicit request =&gt;
  RequestHeaderAttrHelper.get(MyKey) match {
    case Right(value) =&gt;
      // 属性の取得に成功した場合の処理
      Ok(&quot;Got value: &quot; + value)
    case Left(result) =&gt;
      // 属性の取得に失敗した場合の処理
      result
  }
}
</code></pre>
<p>この例では、まずMyKeyというTypedKeyを定義しています。このキーは、リクエストヘッダーに格納された属性を識別するためのものです。そして、getメソッドを使用して、リクエストヘッダーからMyKeyに対応する値を取得しています。</p>
<p>以上がRequestHeaderAttrHelperの基本的な使用方法です。このヘルパーを使用することで、Play Frameworkのリクエストヘッダーから特定の属性を簡単に取得することができます。</p>
<h2><a href="#baseextensionmethods" name="baseextensionmethods" class="anchor"><span class="anchor-link"></span></a>BaseExtensionMethods</h2>
<p>BaseExtensionMethodsは、Play FrameworkのBaseControllerHelpersを拡張するためのトレイトです。このトレイトは、リクエストヘッダーから特定の属性を取得したり、フォームデータを特定の型にバインドしたり、デバイス情報を取得したりするためのヘルパーオブジェクトやメソッドを提供します。</p>
<p>以下に、BaseExtensionMethodsの使用方法を示します。</p>
<p>まず、BaseExtensionMethodsをミックスインしたコントローラーを定義します。このコントローラーは、BaseExtensionMethodsが提供するヘルパーオブジェクトやメソッドを使用することができます。</p>
<pre class="prettyprint"><code class="language-scala">import ixias.play.api.mvc.BaseExtensionMethods
import play.api.mvc._

class MyController @Inject() (implicit cc: MessagesControllerComponents) extends AbstractController(cc) with BaseExtensionMethods {
  // ...
}
</code></pre>
<p>BaseExtensionMethodsを使用すると先ほどまで紹介した機能をエイリアス名で使用できるようになります。</p>
<table>
  <thead>
    <tr>
      <th>機能 </th>
      <th>エイリアス名 </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>JsonHelper </td>
      <td>JsonHelper </td>
    </tr>
    <tr>
      <td>FormHelper </td>
      <td>FormHelper </td>
    </tr>
    <tr>
      <td>DeviceDetectionBuilder </td>
      <td>DeviceDetection </td>
    </tr>
    <tr>
      <td>RequestHeaderAttrHelper </td>
      <td>AttrHelper </td>
    </tr>
  </tbody>
</table>
<div class="source-github">
The source code for this page can be found <a href="https://github.com/nextbeat-dev/ixias/tree/v2.3.0/docs/target/mdoc/04-Play-Framework.md">here</a>.
</div>

<div class="nav-next">
<p><strong>Next:</strong> <a href="05-AWS.html">AWS</a></p>
</div>
</div>
<div class="large-3 show-for-large column" data-sticky-container>
<nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
<div class="page-nav">
<div class="nav-title">On this page:</div>
<div class="nav-toc">
<ul>
  <li><a href="04-Play-Framework.html#play-framework" class="header">Play Framework</a>
  <ul>
    <li><a href="04-Play-Framework.html#jsonhelper" class="header">JsonHelper</a></li>
    <li><a href="04-Play-Framework.html#formhelper" class="header">FormHelper</a></li>
    <li><a href="04-Play-Framework.html#binder" class="header">Binder</a></li>
    <li><a href="04-Play-Framework.html#devicedetection" class="header">DeviceDetection</a></li>
    <li><a href="04-Play-Framework.html#requestheaderattrhelper" class="header">RequestHeaderAttrHelper</a></li>
    <li><a href="04-Play-Framework.html#baseextensionmethods" class="header">BaseExtensionMethods</a></li>
  </ul></li>
</ul>
</div>
</div>
</nav>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2024</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="js/magellan.js"></script>

<style type="text/css">@import "lib/prettify/prettify.css";</style>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>
<script type="text/javascript">jQuery(function(jq){initOldVersionWarnings(jq, '2.3.0', 'https://nextbeat-dev.github.io/ixias/')});</script>


</html>
